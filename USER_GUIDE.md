# NEVの窓 ブラウザ版 - 利用ガイド

## はじめに

このガイドは、コーディング初心者の方でもNEVの窓ブラウザ版を簡単に更新・管理できるように作成されました。

## 📖 目次

1. [基本的な使い方](#基本的な使い方)
2. [情報の閲覧](#情報の閲覧)
3. [情報の編集](#情報の編集)
4. [よくある質問](#よくある質問)
5. [トラブルシューティング](#トラブルシューティング)

---

## 基本的な使い方

### ファイルを開く

1. `index.html` をダブルクリックしてブラウザで開きます
2. 自動的にNEVの窓のホーム画面が表示されます

### 画面の説明

- **全員向けタブ**: 全職員向けの情報が表示されます
- **職員向けタブ**: 職員専用の情報が表示されます
- **検索ボックス**: キーワードを入力して情報を検索できます（各タブの最上部に配置）

---

## 情報の閲覧

### タブの切り替え

- 画面上部の「全員向け」または「職員向け」ボタンをクリックして、表示する情報を切り替えられます

### 検索機能

検索ボックスに文字を入力すると、その文字が含まれるセクションだけが表示されます。

#### 検索の仕組み

- **リアルタイム検索**: 文字を入力すると即座に結果が表示されます
- **部分一致**: 検索ワードが一部でも含まれていれば表示されます
- **大文字小文字を区別しない**: 「カレンダー」でも「かれんだー」でも検索できます
- **タブ別に検索**: 全員向けと職員向けで別々に検索できます

#### 検索対象

検索は以下の情報を対象としています：
- セクション名（例：「INFORMATION」「共通コーナー」）
- 日付（例：「2025.11.10」）
- タイトル/内容（例：「職場環境改善」「就業規則」）
- 詳細情報（例：「ハラスメント」「カレンダー」）
- リンクテキスト（例：「投書箱」「マニュアル」）

#### 使い方

1. 画面上部の検索ボックス（🔍 検索...）にキーワードを入力します
2. 入力すると自動的に該当する情報のみが表示されます
3. 検索ボックスを空にすると、すべての情報が再表示されます

#### 検索の例

**例1: 「職場環境」で検索した場合**
- 「職場環境改善に向けた投書箱の設置」の項目だけが表示されます
- 他の項目は非表示になります

**例2: 「カレンダー」で検索した場合**
- 「R6年度カレンダー」と「R7年度カレンダー」が含まれるセクションが表示されます

**例3: 「就業規則」で検索した場合（職員向けタブ）**
- 「就業規則」「契約職員規程」「時間外勤務実施要領」などが含まれるセクションが表示されます

#### 検索のコツ

- **具体的なキーワード**: 「職場環境」「カレンダー」など具体的な言葉で検索すると見つけやすいです
- **短いキーワード**: 長い文章よりも、短いキーワードの方が検索しやすいです
- **複数の言葉で試す**: 見つからない場合は、別の言葉で検索してみてください

---

## 情報の編集

### ステップ1: 編集モードを開く

1. `admin.html` を直接ダブルクリックして開きます
2. ファイル共有（file://）から開く場合は、「📤 data.jsonをアップロード」ボタンが表示されるので、data.jsonを選択してアップロードします
3. Webサーバー経由（http://）で開く場合は、自動的にdata.jsonが読み込まれます

### ステップ2: セクションを編集する

1. 編集したいセクションを見つけます
2. そのセクションの「✏️ 編集」ボタンをクリックします
3. テキストエリアが表示されます

### ステップ3: 内容を変更する

#### お知らせを追加する場合

テキストエリアに以下のような形式で情報が表示されています：

```json
{
  "name": "INFORMATION",
  "items": [
    {
      "date": "2025.11.05",
      "content": "お知らせのタイトル",
      "detail": "詳細情報"
    }
  ]
}
```

**新しいお知らせを追加する手順：**

1. 既存の項目（`{` から `}` まで）をコピーします
2. カンマ(`,`)の後に貼り付けます
3. 日付、内容、詳細を変更します

例：
```json
{
  "name": "INFORMATION",
  "items": [
    {
      "date": "2025.11.05",
      "content": "既存のお知らせ",
      "detail": "詳細情報"
    },
    {
      "date": "2025.11.06",
      "content": "新しいお知らせ",
      "detail": "新しい詳細情報"
    }
  ]
}
```

#### リスト項目を追加する場合

リスト形式のセクション（例：共通コーナー）は以下のようになっています：

```json
{
  "name": "共通コーナー（全職員向け）",
  "items": [
    "R6年度カレンダー",
    "R7年度カレンダー"
  ]
}
```

**新しい項目を追加する手順：**

1. 既存の項目をコピーします（例：`"R6年度カレンダー"`）
2. カンマの後に貼り付けます
3. 内容を変更します

例：
```json
{
  "name": "共通コーナー（全職員向け）",
  "items": [
    "R6年度カレンダー",
    "R7年度カレンダー",
    "R8年度カレンダー"
  ]
}
```

### ステップ4: 変更を保存する

1. 「💾 保存」ボタンをクリックします
2. エラーがなければ、成功メッセージが表示されます
3. 画面上部の「💾 data.jsonをダウンロード」ボタンをクリックします
4. ダウンロードした `data.json` ファイルを元の場所に置き換えます

### ステップ5: 変更を確認する

1. ダウンロードした `data.json` を共有フォルダの元のファイルと置き換えます
2. **重要**: `python generate_html.py` を実行して、index.htmlを再生成します
   ```cmd
   cd \\cev-file5\share\NEVの窓ブラウザ版\
   python generate_html.py
   ```
3. `index.html` を開いてブラウザで変更を確認します

---

## よくある質問

### Q1: 編集した内容が反映されません

**A:** 以下を確認してください：
1. 「保存」ボタンをクリックしましたか？
2. `data.json` ファイルをダウンロードして置き換えましたか？
3. ブラウザを更新（F5キー）しましたか？

### Q2: エラーメッセージが表示されました

**A:** 「JSONの形式が正しくありません」というエラーの場合：
- カンマ(`,`)が正しく配置されているか確認してください
- 括弧 `{` と `}` が対応しているか確認してください
- ダブルクォーテーション(`"`)が閉じられているか確認してください

### Q3: 誤って削除してしまいました

**A:** バックアップから復元してください：
1. 事前に保存していた `data.json` のバックアップを探します
2. それを元の場所に置き換えます
3. ブラウザを更新します

### Q4: どこを編集すればいいかわかりません

**A:** 編集画面で各セクションのプレビューを見ながら、該当するセクションの「編集」ボタンをクリックしてください。

---

## トラブルシューティング

### 問題: 画面が真っ白になった

**原因:** data.jsonファイルの形式が壊れている可能性があります

**解決方法:**
1. バックアップの `data.json` を復元します
2. ブラウザのコンソール（F12キー）でエラーメッセージを確認します

### 問題: 編集内容が保存されない

**原因:** ブラウザのセキュリティ設定の問題

**解決方法:**
1. 編集後、必ず「data.jsonをダウンロード」を実行してください
2. ダウンロードしたファイルを手動で元の場所に置き換えてください

### 問題: 日本語が文字化けする

**原因:** ファイルのエンコーディングの問題

**解決方法:**
1. ファイルをUTF-8エンコーディングで保存してください
2. ブラウザの文字エンコーディング設定を確認してください

---

## 重要な注意事項

1. **必ずバックアップを取る**: 編集前に `data.json` ファイルのコピーを保存してください
2. **形式を守る**: JSON形式を壊さないよう、既存の形式をコピーして使用してください
3. **テストする**: 大きな変更を加えた後は、必ず動作を確認してください
4. **段階的に編集**: 一度に多くの変更を加えず、少しずつ編集して保存してください

---

## サポート

問題が解決しない場合は、システム管理者に連絡してください。

その際、以下の情報を伝えてください：
- 何をしようとしていたか
- どのような操作を行ったか
- 表示されたエラーメッセージ（あれば）
- 使用しているブラウザの種類とバージョン

---

**最終更新日**: 2025年11月5日
