# NEVの窓 - ブラウザ版

NEVの窓_1110.xlsxをブラウザ版に変換したシステムです。

## 📋 概要

社内掲示板「NEVの窓」をExcelファイルからWebブラウザで閲覧できる形式に変換しました。
全員向けと職員向けの2つのタブで情報を管理し、検索機能も備えています。

## 🎯 特徴

- **静的HTML**: data.jsonの内容をHTMLに直接埋め込み、ページ読み込みが高速
- **サーバー不要**: ブラウザで直接開けます（ファイル共有から）
- **検索機能**: リアルタイムでコンテンツを検索
- **リンク対応**: Excelに設定されていた126個のハイパーリンクを保持
- **簡単編集**: 非技術者でも編集可能な管理画面付き

## 📁 ファイル構成

```
NEVの窓ブラウザ版/
├── index.html          # メイン表示ページ（自動生成）
├── admin.html          # 編集モード
├── style.css           # 共通スタイル
├── admin.css           # 管理画面スタイル
├── admin.js            # 管理画面スクリプト
├── data.json           # 掲示板データ
├── generate_html.py    # HTML生成スクリプト
├── README.md           # このファイル
├── USER_GUIDE.md       # 詳細ユーザーガイド
├── QUICK_START.md      # クイックスタート
└── DEPLOYMENT_GUIDE.md # デプロイガイド
```

## 🚀 使い方

### 閲覧方法

1. **共有フォルダにデプロイ**（推奨）
   ```
   \\cev-file5\share\NEVの窓ブラウザ版\
   ```
   すべてのファイルを共有フォルダにコピー

2. **index.htmlを開く**
   - 共有フォルダのindex.htmlをダブルクリック
   - ブラウザが開き、掲示板が表示されます

3. **閲覧**
   - 「全員向け」「職員向け」タブで切り替え
   - 検索ボックスで情報を検索

### 検索機能の使い方

検索ボックスにキーワードを入力すると、該当するセクションのみが表示されます。

**検索対象:**
- セクション名、日付、タイトル、詳細情報、リンクテキスト

**検索の特徴:**
- リアルタイム検索（入力と同時に結果表示）
- 部分一致検索
- 大文字小文字を区別しない
- ひらがな・カタカナを区別しない（「かれんだー」で「カレンダー」が検索可能）
- タブごとに検索可能

**例:**
- 「職場環境」→ 職場環境改善に関する項目のみ表示
- 「カレンダー」→ カレンダー関連のセクション表示
- 「就業規則」→ 就業規則関連の項目表示（職員向けタブ）

詳しくは **USER_GUIDE.md** の「検索機能」セクションを参照してください。
   - 検索ボックスで情報を検索
   - 青色のリンクをクリックしてファイルにアクセス

### 更新方法

#### ステップ1: データを編集

1. **admin.htmlを開く**
   ```
   \\cev-file5\share\NEVの窓ブラウザ版\admin.html
   ```

2. **編集したいセクションの「編集」ボタンをクリック**

3. **内容を編集**
   - JSON形式で編集
   - 日付、内容、リンクなどを変更

4. **「保存」をクリック**

5. **「💾 data.jsonをダウンロード」をクリック**

6. **ダウンロードしたファイルで共有フォルダのdata.jsonを置き換え**

#### ステップ2: HTMLを再生成

data.jsonを更新したら、以下のコマンドを実行してindex.htmlを更新します：

```cmd
cd \\cev-file5\share\NEVの窓ブラウザ版\
python generate_html.py
```

これで、index.htmlにdata.jsonの最新内容が反映されます。

**重要**: data.jsonを更新したら、必ず `python generate_html.py` を実行してください。
実行しないと、index.htmlに変更が反映されません。

## 💡 なぜこの方式なのか

### 従来方式（動的読み込み）の問題
- ブラウザのセキュリティ制限（CORS）により、ローカルファイルシステムからdata.jsonを読み込めない
- ページ読み込みのたびにJSONファイルの取得が必要
- エラーが発生しやすい

### 新方式（静的HTML）の利点
- ✅ HTMLにデータが直接埋め込まれているため、ファイル共有から直接開ける
- ✅ ページ読み込みが高速
- ✅ CORSエラーが発生しない
- ✅ ネットワーク接続不要

## 📊 データ統計

- **全員向け**: 58項目
- **職員向け**: 73項目
- **合計リンク数**: 126個
- **リンクタイプ**: ファイル共有パス、相対パス、Webリンク

## 🔧 技術詳細

### データ構造

```json
{
  "全員向け": {
    "title": "全員向け情報",
    "sections": [
      {
        "name": "INFORMATION",
        "items": [
          {
            "date": "2025.11.10",
            "content": "職場環境改善に向けた投書箱の設置",
            "detail": "投書箱（MSFORMS）",
            "link": "INFORMATION\\投書箱.pdf"
          }
        ]
      }
    ]
  }
}
```

### HTML生成プロセス

1. `generate_html.py` がdata.jsonを読み込む
2. データをHTMLに変換（HTMLエスケープ処理）
3. タブ、検索、リンクなどの機能を含むHTMLを生成
4. index.htmlに書き込む

## 🛠️ トラブルシューティング

### Q: HTMLを更新したのに変更が反映されない
A: ブラウザのキャッシュをクリアしてください（Ctrl + F5）

### Q: Pythonがインストールされていない
A: 以下の手順でインストール：
1. [Python公式サイト](https://www.python.org/downloads/)からダウンロード
2. インストーラーを実行
3. 「Add Python to PATH」にチェックを入れる

### Q: リンクをクリックしてもファイルが開かない
A: 
- ファイル共有パスの場合、サーバーにアクセスできるか確認
- ネットワーク接続を確認
- ファイルへのアクセス権限を確認

## 📚 ドキュメント

- **USER_GUIDE.md**: 詳細な利用ガイド（非技術者向け）
- **QUICK_START.md**: 5ステップの簡易ガイド
- **DEPLOYMENT_GUIDE.md**: デプロイ方法とトラブルシューティング

## 🔒 セキュリティ

- HTMLエスケープ処理によりXSS攻撃を防止
- すべてのユーザー入力を適切にエスケープ
- CodeQL検証済み（セキュリティアラート0件）

## 📞 サポート

詳しい使い方や問題が発生した場合は、以下のドキュメントを参照してください：

- [ユーザーガイド](USER_GUIDE.md)
- [クイックスタート](QUICK_START.md)
- [デプロイガイド](DEPLOYMENT_GUIDE.md)

---

**最終更新日**: 2025年11月7日  
**バージョン**: 2.0（静的HTML方式）
